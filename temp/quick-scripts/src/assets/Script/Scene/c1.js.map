{"version":3,"sources":["assets/Script/Scene/c1.js"],"names":["global","require","cc","Class","Component","properties","restart","type","Node","num","Label","map","block","Prefab","tips","stage","boo","bg","onLoad","wx","showShareMenu","withShareTicket","updateShareMenu","onShareAppMessage","title","imageUrl","success","res","showModal","content","fail","argument","game","manager","director","getCollisionManager","enabled","bonus","ori_xv","ori_xa","xv","xa","distance","gameover","word","edge","boo_move","node","on","event","setBLock","instantiate","setPosition","mode","parent","setNum","string","setTip","str","end","update","dt","x","Math","seededRandom","action","tintTo","runAction","y","scaleX","max","scaleY"],"mappings":"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","sourceRoot":"/","sourcesContent":["var global = require(\"global\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        restart: {\n            default: null,\n            type: cc.Node\n        },\n        num: {\n            default: null,\n            type: cc.Label\n        },\n        map: {\n            default: null,\n            type: cc.Node\n        },\n        block: {\n            default: [],\n            type: cc.Prefab\n        },\n        tips: {\n            default: null,\n            type: cc.Label\n        },\n        stage: {\n            default: null,\n            type: cc.Node\n        },\n        boo: {\n            default: null,\n            type: cc.Node\n        },\n        bg: {\n            default: null,\n            type: cc.Node\n        }\n    },\n\n    // use this for initialization\n    onLoad: function () {\n\n        if(typeof(wx) != \"undefined\") {\n            wx.showShareMenu({\n              withShareTicket: true\n            });\n\n            wx.updateShareMenu({\n              withShareTicket: true\n            });\n\n            wx.onShareAppMessage(function () {\n              // 用户点击了“转发”按钮\n              return {\n                title: '小卜与花生的故事，想要讲给你听……',\n                imageUrl: \"res/raw-assets/Texture/share/s3.png\",\n                success: function(res) {\n                }\n              }\n            });\n\n            wx.showModal({\n                title: '小卜:',\n                content: '这里是练习模式，没有分数和排行，只有一个小故事，随时可以点击左下角按钮退出',\n                success: function (res) {\n\n                },\n                fail: function (argument) {\n\n                }\n            });\n        }\n\n        global.game = this;\n\n        var manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n        // manager.enabledDebugDraw = true;\n        // manager.enabledDrawBoundingBox = true;\n\n        global.bonus = 0;\n\n        this.boo.ori_xv = 1;\n        this.boo.ori_xa = 0.2;\n        this.boo.xv = this.boo.ori_xv;\n        this.boo.xa = this.boo.ori_xa;\n\n        global.distance = 0;\n        global.num = 0;\n        global.gameover = false;\n\n        global.word = 0;\n\n        this.edge = 0;\n\n        this.boo_move = false;\n\n        this.node.on('touchstart', function ( event ) {\n            if(!global.gameover) {\n                this.boo.xv = this.boo.ori_xv;\n                this.boo.xa = this.boo.ori_xa;\n                this.boo_move = true;\n            }\n        }, this);\n        this.node.on('touchend', function ( event ) {\n            this.boo_move = false;\n        }, this);\n\n\n        this.restart.on('touchstart', function ( event ) {\n            cc.game.restart();\n        }, this);\n\n    },\n\n    setBLock: function() {\n        var block = cc.instantiate(this.block[0]);\n        block.setPosition(global.distance + 400, -100);\n        block.mode = \"c1\";\n\n        block.parent = this.map;\n    },\n\n    setNum: function(num) {\n        global.num += num + global.bonus;\n        this.num.string = global.num;\n    },\n\n    setTip: function(str) {\n        this.tips.string = str;\n    },\n\n    end: function() {\n        global.gameover = true;\n\n        if(typeof(wx) != \"undefined\") {\n            wx.showModal({\n                title: '小卜:',\n                content: '返回主菜单咯~',\n                success: function (res) {\n                    cc.game.restart();\n                },\n                fail: function (argument) {\n                    cc.game.restart();\n                }\n            });\n        }\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n\n        /*var color = this.bg.color;\n        if (color.equals(cc.Color.BLACK)) {\n            return;\n        }*/\n        // this.ratio += dt * 0.01;\n        // this.bg.color = cc.Color.WHITE.lerp(cc.Color.WHITE, this.ratio);\n\n        if(this.boo_move) {\n            global.distance += this.boo.xv;\n            this.map.x -= this.boo.xv;\n            this.boo.xv += this.boo.xa;\n            // this.boo.xv = Math.min(this.boo.xv, 10)\n\n            if(global.distance > this.edge) {\n                this.edge += 200 + Math.seededRandom() * 50 + this.boo.xv * this.boo.xv;\n                this.setBLock();\n                if(global.num % 50 > 45) {\n                    var action = cc.tintTo(2, Math.seededRandom() * 255, Math.seededRandom() * 255, Math.seededRandom() * 255);\n                    this.bg.runAction(action);\n                }\n            }\n        }\n\n        if(!global.gameover) {\n            if(this.boo.y > 400) {\n                this.stage.scaleX = Math.max(0.2, 1 - (this.boo.y - 400) / 1000);\n                this.stage.scaleY = Math.max(0.2, 1 - (this.boo.y - 400) / 1000);\n            } else {\n                this.stage.scaleX = 1;\n                this.stage.scaleY = 1;\n            }\n        }\n\n    },\n});\n"]}