{"version":3,"sources":["assets/Script/Game/gameover.js"],"names":["global","require","cc","Class","Component","properties","item","type","Node","all_rank","f_rank","w_rank","content","restart","btn_rank","btn_bbs","btn_msg","btn_cancel","btn_share","bbs","msg","EditBox","onLoad","rank","wx","info","getSystemInfoSync","leitaiAd","createBannerAd","adUnitId","style","left","top","windowHeight","width","windowWidth","height","on","event","hide","game","active","shareAppMessage","title","imageUrl","canvas","toTempFilePathSync","x","y","destWidth","destHeight","success","res","showModal","fail","argument","self","string","length","login","loginCode","data","request","url","method","header","end","console","log","record","gameover","showWrank","showFrank","show","code","i","genItem","instantiate","ava","loader","load","err","img","getChildByName","getComponent","Sprite","spriteFrame","SpriteFrame","Label","name","num","parent"],"mappings":"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","sourceRoot":"/","sourcesContent":["var global = require(\"global\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        item: {\n            default: null,\n            type: cc.Node\n        },\n        all_rank: {\n            default: null,\n            type: cc.Node\n        },\n        f_rank: {\n            default: null,\n            type: cc.Node\n        },\n        w_rank: {\n            default: null,\n            type: cc.Node\n        },\n        content: {\n            default: null,\n            type: cc.Node\n        },\n        restart: {\n            default: null,\n            type: cc.Node\n        },\n        btn_rank: {\n            default: null,\n            type: cc.Node\n        },\n        btn_bbs: {\n            default: null,\n            type: cc.Node\n        },\n        btn_msg: {\n            default: null,\n            type: cc.Node\n        },\n        btn_cancel: {\n            default: null,\n            type: cc.Node\n        },\n        btn_share: {\n            default: null,\n            type: cc.Node\n        },\n        bbs: {\n            default: null,\n            type: cc.Node\n        },\n        msg: {\n            default: null,\n            type: cc.EditBox\n        },\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        global.rank = this;\n\n        if(typeof(wx) != \"undefined\") {\n            var info = wx.getSystemInfoSync();\n            this.leitaiAd = wx.createBannerAd({\n                adUnitId: 'adunit-xxxxxxxx',\n                style: {\n                    left: 0,\n                    top: info.windowHeight - 110,\n                    width: info.windowWidth,\n                    height: 110\n                }\n            });\n        }\n\n        this.restart.on('touchstart', function ( event ) {\n            this.leitaiAd.hide();\n            cc.game.restart();\n        }, this);\n\n        this.btn_bbs.on('touchstart', function ( event ) {\n            this.bbs.active = true;\n        }, this);\n\n        this.btn_cancel.on('touchstart', function ( event ) {\n            this.bbs.active = false;\n        }, this);\n\n        this.btn_share.on('touchstart', function ( event ) {\n            if(typeof(wx) != \"undefined\") {\n                wx.shareAppMessage({\n                    title: '看见了吗？这位就是今天的擂主~',\n                    imageUrl: canvas.toTempFilePathSync({\n                        x: 75,\n                        y: 300,\n                        width: 600,\n                        height: 480,\n                        destWidth: 500,\n                        destHeight: 400\n                    }),\n                    success: function(res) {\n                    }\n                });\n            }\n        }, this);\n\n        global.msg = true;\n        this.btn_msg.on('touchstart', function ( event ) {\n            if(typeof(wx) != \"undefined\") {\n                if(!global.msg) {\n                    wx.showModal({\n                        title: '小卜:',\n                        content: '你已经留言过了哟~',\n                        success: function (res) {\n\n                        },\n                        fail: function (argument) {\n\n                        }\n                    });\n                    return;\n                }\n\n                var self = this;\n                var msg = this.msg.string;\n\n                if(msg.length == 0) {\n                    return;\n                }\n                global.msg = false;\n                wx.showModal({\n                    title: '小卜:',\n                    content: '我收到了哟~',\n                    success: function (res) {\n                        self.bbs.active = false;\n                    },\n                    fail: function (argument) {\n                        self.bbs.active = false;\n                    }\n                });\n                wx.login({\n                  success: function (loginCode) {\n                        self.data = {};\n\n                        wx.request({\n                            url: 'https://url/',\n                            method: 'POST',\n                            data: self.data,\n                            header: {\n                                //设置参数内容类型为x-www-form-urlencoded\n                                'Content-Type':'application/x-www-form-urlencoded',\n                                'Accept': 'application/json'\n                            },\n                            success: function (res) {\n                            },\n                            fail: function (res) {\n                                // console.log('f',res)\n                            }\n                        });\n                    }\n                });\n            }\n\n        }, this);\n\n        /*this.rank_flag = \"w\";\n        this.btn_rank.on('touchstart', function ( event ) {\n            switch(this.rank_flag) {\n                case \"f\":\n                    this.w_rank.active = true;\n                    this.f_rank.active = false;\n                    this.rank_flag = \"w\";\n                    this.btn_rank.getChildByName(\"btn_f_rank\").active = false;\n                    this.btn_rank.getChildByName(\"btn_w_rank\").active = true;\n                break;\n                case \"w\":\n                    this.w_rank.active = false;\n                    this.f_rank.active = true;\n                    this.rank_flag = \"f\";\n                    this.btn_rank.getChildByName(\"btn_w_rank\").active = false;\n                    this.btn_rank.getChildByName(\"btn_f_rank\").active = true;\n                break;\n            }\n        }, this);*/\n\n    },\n\n    end: function() {\n        console.log(global.record)\n        this.all_rank.active = true;\n        global.gameover = true;\n\n        this.showWrank();\n        // this.showFrank();\n    },\n\n    showFrank: function(argument) {\n        /*var openDataContext = wx.getOpenDataContext();\n        openDataContext.postMessage([\n            {key: \"num\",value: global.num}\n        ]);*/\n    },\n\n    showWrank: function(data) {\n        this.all_rank.active = true;\n        if(typeof(wx) != \"undefined\") {\n\n            this.leitaiAd.show();\n\n            var self = this;\n\n            wx.login({\n              success: function (loginCode) {\n\n                data.loginCode = loginCode.code;\n\n                wx.request({\n                    url: 'https://url/',\n                    method: 'POST',\n                    data: data,    //参数为键值对字符串\n                    header: {\n                        //设置参数内容类型为x-www-form-urlencoded\n                        'Content-Type':'application/x-www-form-urlencoded',\n                        'Accept': 'application/json'\n                    },\n                    success: function (res) {\n                        for (var i = 0; i < res.data.length; i++) {\n                            self.genItem(i, res.data[i]);\n                        }\n                    },\n                    fail: function (res) {\n                        // console.log('f',res)\n                    }\n                });\n\n              }\n            });\n\n        }\n    },\n\n    genItem: function(i, res) {\n        var item = cc.instantiate(this.item);\n        if(res.ava) {\n            cc.loader.load({url:res.ava, type: 'png'}, function (err, img) {\n                item.getChildByName(\"ava\").getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(img);\n            });\n        }\n\n        item.getChildByName(\"raw\").getComponent(cc.Label).string = i + 1;\n        item.getChildByName(\"name\").getComponent(cc.Label).string = res.name;\n        item.getChildByName(\"num\").getComponent(cc.Label).string = res.num;\n\n        // item.active = true;\n\n        item.parent = this.content;\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    /*update: function (dt) {\n\n    },*/\n});\n"]}