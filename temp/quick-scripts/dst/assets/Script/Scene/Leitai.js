
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Scene/Leitai.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '2a90axHM0VPjKpjIGxdKs+2', 'Leitai');
// Script/Scene/Leitai.js

"use strict";

var global = require("global");

cc.Class({
  "extends": cc.Component,
  properties: {
    num: {
      "default": null,
      type: cc.Label
    },
    map: {
      "default": null,
      type: cc.Node
    },
    block: {
      "default": [],
      type: cc.Prefab
    },
    prop: {
      "default": [],
      type: cc.Prefab
    },
    tips: {
      "default": null,
      type: cc.Label
    },
    stage: {
      "default": null,
      type: cc.Node
    },
    boo: {
      "default": null,
      type: cc.Node
    },
    bg: {
      "default": null,
      type: cc.Node
    }
    /*stage2: {
        default: null,
        type: cc.Node
    },
    map2: {
        default: null,
        type: cc.Node
    },
    boo2: {
        default: null,
        type: cc.Node
    }*/

  },
  // use this for initialization
  onLoad: function onLoad() {
    global.game = this;
    var manager = cc.director.getCollisionManager();
    manager.enabled = true; // manager.enabledDebugDraw = true;
    // manager.enabledDrawBoundingBox = true;
    // 擂台赛记录

    Math.seed = new Date().getDate();
    this.seed = Math.seed;
    /*global.time = 0;
    global.record = {};
    this.r_data = JSON.parse(cc.sys.localStorage.getItem('r'));
    this.r_data = this.r_data || {
        12:"1",
        18:"0",
        22:"1",
        29:"0",
        32:"1",
        44:"0",
        48:"1",
        57:"0",
        63:"1",
        71:"0",
        75:"1",
        82:"0"
    }*/

    /*this.schedule(function(argument) {
        
        global.time += 1;
         if(this.r_data[global.time] == 1) {
            if(!global.gameover) {
                this.boo2.xv = this.boo2.ori_xv;
                this.boo2.xa = this.boo2.ori_xa;
                this.boo2_move = true;
            }
        }
        if(this.r_data[global.time] == 0) {
            this.boo2_move = false;
        }
    }, 0.01, this);*/
    // 擂台赛

    global.bonus = 0; // this.boo.ori_xv = 1;
    // this.boo.ori_xa = 0.2;

    this.boo.xv = this.boo.ori_xv;
    this.boo.xa = this.boo.ori_xa;
    this.boo.mode = "leitai";
    global.distance = 0;
    global.num = 0;
    global.gameover = false;
    this.edge = 0;
    this.boo_move = false;
    this.node.on('touchstart', function (event) {
      if (!global.gameover) {
        this.boo.xv = this.boo.ori_xv;
        this.boo.xa = this.boo.ori_xa;
        this.boo_move = true; // global.record[global.time] = 1;
      }
    }, this);
    this.node.on('touchend', function (event) {
      this.boo_move = false; // global.record[global.time] = 0;
    }, this);

    if (typeof wx != "undefined") {
      var self = this;
      wx.showShareMenu({
        withShareTicket: true
      });
      wx.updateShareMenu({
        withShareTicket: true
      });
      wx.onShareAppMessage(function () {
        // 用户点击了“转发”按钮
        return {
          title: '好想成为今日擂主啊！',
          imageUrl: "res/raw-assets/Texture/share/s2.png",
          success: function success(res) {}
        };
      });
      wx.login({
        success: function success(loginCode) {
          self.data = {
            'type': 'leitai_check',
            'seed': self.seed,
            'loginCode': loginCode.code
          };
          wx.request({
            url: 'https://url/',
            method: 'POST',
            data: self.data,
            header: {
              //设置参数内容类型为x-www-form-urlencoded
              'Content-Type': 'application/x-www-form-urlencoded',
              'Accept': 'application/json'
            },
            success: function success(res) {
              var t = 3 - res.data[0].num;

              if (res.data[0].num > 10) {
                wx.showModal({
                  title: '小卜:',
                  content: '你已挑战超过10次了哟……去试试最强模式或着练习模式吧~',
                  success: function success(res) {},
                  fail: function fail(argument) {}
                });
                self.outOfToday();
              } else if (t > 0) {
                wx.showModal({
                  title: '小卜:',
                  content: '你今天还剩' + t + '次挑战机会~',
                  success: function success(res) {
                    if (res.cancel) {
                      self.outOfToday();
                    }
                  },
                  fail: function fail(argument) {}
                });
              } else {
                wx.showModal({
                  title: '小卜:',
                  content: '你今天的挑战机会已经用完了哟~，分享到群可以获得额外的挑战机会',
                  success: function success(res) {
                    if (res.confirm) {
                      wx.shareAppMessage({
                        title: '好想成为今日擂主啊！',
                        imageUrl: "res/raw-assets/Texture/share/s2.png",
                        success: function success(res) {
                          if (!res.shareTickets) {
                            wx.showModal({
                              title: '小卜:',
                              content: '不要调皮哦~直接点开始游戏没有每日挑战次数限制~',
                              success: function success(res) {},
                              fail: function fail(argument) {}
                            });
                            self.outOfToday();
                          }
                        },
                        fail: function fail(res) {
                          wx.showModal({
                            title: '小卜:',
                            content: '直接点开始游戏没有每日挑战次数限制哦~',
                            success: function success(res) {},
                            fail: function fail(argument) {}
                          });
                          self.outOfToday();
                        }
                      });
                    } else {
                      wx.showModal({
                        title: '小卜:',
                        content: '直接点开始游戏没有每日挑战次数限制哦~',
                        success: function success(res) {},
                        fail: function fail(argument) {}
                      });
                      self.outOfToday();
                    }
                  },
                  fail: function fail(argument) {
                    self.outOfToday();
                  }
                });
              }
            },
            fail: function fail(res) {// console.log('f',res)
            }
          });
        }
      });
    }
  },
  setBLock: function setBLock() {
    var rand = Math.floor(Math.seededRandom() * this.block.length);
    var block = cc.instantiate(this.block[rand]);
    block.setPosition(global.distance + 400, -100);
    block.scaleX = Math.min(1, Math.max(0, (200 - global.num) / 200)) + Math.seededRandom() * 0.2 + 0.2;
    block.scaleY = block.scaleX;
    /*var block2 = cc.instantiate(block);
    block2.parent = this.map2;*/

    block.parent = this.map;
  },
  setProp: function setProp() {
    var rand = Math.floor(Math.seededRandom() * this.prop.length);
    var prop = cc.instantiate(this.prop[rand]);
    prop.setPosition(global.distance + 400 - Math.seededRandom() * 200, 200);
    prop.seed = Math.seededRandom();
    /*var prop2 = cc.instantiate(prop);
    prop2.seed = prop.seed;
    prop2.parent = this.map2;*/

    prop.parent = this.map;
  },
  setNum: function setNum(num) {
    global.num += num + global.bonus;
    this.num.string = global.num;
  },
  setTip: function setTip(str) {
    this.tips.string = str;
  },
  outOfToday: function outOfToday() {
    // console.log(global.record)
    // cc.sys.localStorage.setItem('r', JSON.stringify(global.record));
    this.boo.destroy();
    var self = this;
    global.gameover = true;
    self.data = {
      'type': 'leitai',
      'seed': self.seed
    };
    global.rank.showWrank(self.data);
  },
  end: function end() {
    // console.log(global.record)
    // cc.sys.localStorage.setItem('r', JSON.stringify(global.record));
    var self = this;
    global.gameover = true;
    /*wx.showModal({
        title: '小卜:',
        content: '完成挑战，现在正在结算你的分数~',
        success: function (res) {
         },
        fail: function (argument) {
         }
    });*/

    self.data = {
      'type': 'leitai',
      'num': global.num,
      'seed': self.seed
    };
    global.rank.showWrank(self.data);
  },
  // called every frame, uncomment this function to activate update callback
  update: function update(dt) {
    /*global.time += 1;
     if(this.r_data[global.time] == 1) {
        if(!global.gameover) {
            this.boo2.xv = this.boo2.ori_xv;
            this.boo2.xa = this.boo2.ori_xa;
            this.boo2_move = true;
        }
    }
    if(this.r_data[global.time] == 0) {
        this.boo2_move = false;
    }
     if(this.boo2_move) {
        this.map2.x -= this.boo2.xv;
        this.boo2.xv += this.boo2.xa;
         this.stage2.x += this.boo2.xv;
    }*/
    if (this.boo_move) {
      this.map.x -= this.boo.xv;
      this.boo.xv += this.boo.xa; // this.stage2.x -= this.boo.xv;
    } // if(this.boo2_move || this.boo_move) {


    if (this.boo_move) {
      global.distance += this.boo.xv; // global.distance = Math.max(-this.map.x, -this.map2.x);
      // this.stage2.x = this.map.x - this.map2.x;

      if (global.distance > this.edge) {
        this.edge += 200 + Math.seededRandom() * 200 + this.boo.xv * this.boo.xv;
        this.setBLock();

        if (global.num % 50 > 45) {
          var action = cc.tintTo(2, Math.seededRandom() * 255, Math.seededRandom() * 255, Math.seededRandom() * 255);
          this.bg.runAction(action);
        }

        if (Math.seededRandom() < 0.3) {
          this.setProp();
        }
      }
    }
    /*if(!global.gameover) {
        if(this.boo.y > 400) {
            this.stage.scaleX = Math.max(0.2, 1 - (this.boo.y - 400) / 1000);
            this.stage.scaleY = Math.max(0.2, 1 - (this.boo.y - 400) / 1000);
        } else {
            this.stage.scaleX = 1;
            this.stage.scaleY = 1;
        }
    }*/

  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9TY3JpcHQvU2NlbmUvTGVpdGFpLmpzIl0sIm5hbWVzIjpbImdsb2JhbCIsInJlcXVpcmUiLCJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIm51bSIsInR5cGUiLCJMYWJlbCIsIm1hcCIsIk5vZGUiLCJibG9jayIsIlByZWZhYiIsInByb3AiLCJ0aXBzIiwic3RhZ2UiLCJib28iLCJiZyIsIm9uTG9hZCIsImdhbWUiLCJtYW5hZ2VyIiwiZGlyZWN0b3IiLCJnZXRDb2xsaXNpb25NYW5hZ2VyIiwiZW5hYmxlZCIsIk1hdGgiLCJzZWVkIiwiRGF0ZSIsImdldERhdGUiLCJib251cyIsInh2Iiwib3JpX3h2IiwieGEiLCJvcmlfeGEiLCJtb2RlIiwiZGlzdGFuY2UiLCJnYW1lb3ZlciIsImVkZ2UiLCJib29fbW92ZSIsIm5vZGUiLCJvbiIsImV2ZW50Iiwid3giLCJzZWxmIiwic2hvd1NoYXJlTWVudSIsIndpdGhTaGFyZVRpY2tldCIsInVwZGF0ZVNoYXJlTWVudSIsIm9uU2hhcmVBcHBNZXNzYWdlIiwidGl0bGUiLCJpbWFnZVVybCIsInN1Y2Nlc3MiLCJyZXMiLCJsb2dpbiIsImxvZ2luQ29kZSIsImRhdGEiLCJjb2RlIiwicmVxdWVzdCIsInVybCIsIm1ldGhvZCIsImhlYWRlciIsInQiLCJzaG93TW9kYWwiLCJjb250ZW50IiwiZmFpbCIsImFyZ3VtZW50Iiwib3V0T2ZUb2RheSIsImNhbmNlbCIsImNvbmZpcm0iLCJzaGFyZUFwcE1lc3NhZ2UiLCJzaGFyZVRpY2tldHMiLCJzZXRCTG9jayIsInJhbmQiLCJmbG9vciIsInNlZWRlZFJhbmRvbSIsImxlbmd0aCIsImluc3RhbnRpYXRlIiwic2V0UG9zaXRpb24iLCJzY2FsZVgiLCJtaW4iLCJtYXgiLCJzY2FsZVkiLCJwYXJlbnQiLCJzZXRQcm9wIiwic2V0TnVtIiwic3RyaW5nIiwic2V0VGlwIiwic3RyIiwiZGVzdHJveSIsInJhbmsiLCJzaG93V3JhbmsiLCJlbmQi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QUFnQztBQUM1QixhQUFLQSxJQUFMLElBQWEsTUFBTVosSUFBSSxDQUFDZ0QsWUFBTCxLQUFzQixHQUE1QixHQUFrQyxLQUFLeEQsR0FBTCxDQUFTYSxFQUFULEdBQWMsS0FBS2IsR0FBTCxDQUFTYSxFQUF0RTtBQUNBLGFBQUt3QyxRQUFMOztBQUNBLFlBQUdyRSxNQUFNLENBQUNNLEdBQVAsR0FBYSxFQUFiLEdBQWtCLEVBQXJCLEVBQXlCO0FBQ3JCLGNBQUl1RixNQUFNLEdBQUczRixFQUFFLENBQUM0RixNQUFILENBQVUsQ0FBVixFQUFhdEUsSUFBSSxDQUFDZ0QsWUFBTCxLQUFzQixHQUFuQyxFQUF3Q2hELElBQUksQ0FBQ2dELFlBQUwsS0FBc0IsR0FBOUQsRUFBbUVoRCxJQUFJLENBQUNnRCxZQUFMLEtBQXNCLEdBQXpGLENBQWI7QUFDQSxlQUFLdkQsRUFBTCxDQUFROEUsU0FBUixDQUFrQkYsTUFBbEI7QUFDSDs7QUFDRCxZQUFHckUsSUFBSSxDQUFDZ0QsWUFBTCxLQUFzQixHQUF6QixFQUE4QjtBQUMxQixlQUFLUyxPQUFMO0FBQ0g7QUFDSjtBQUNKO0FBRUQ7Ozs7Ozs7Ozs7QUFVSDtBQXBaSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZ2xvYmFsID0gcmVxdWlyZShcImdsb2JhbFwiKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG51bToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLkxhYmVsXG4gICAgICAgIH0sXG4gICAgICAgIG1hcDoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgYmxvY2s6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXG4gICAgICAgIH0sXG4gICAgICAgIHByb3A6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXG4gICAgICAgIH0sXG4gICAgICAgIHRpcHM6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxuICAgICAgICB9LFxuICAgICAgICBzdGFnZToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgYm9vOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICBiZzoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgLypzdGFnZTI6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIG1hcDI6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIGJvbzI6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0qL1xuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuXG5cbiAgICAgICAgZ2xvYmFsLmdhbWUgPSB0aGlzO1xuXG4gICAgICAgIHZhciBtYW5hZ2VyID0gY2MuZGlyZWN0b3IuZ2V0Q29sbGlzaW9uTWFuYWdlcigpO1xuICAgICAgICBtYW5hZ2VyLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAvLyBtYW5hZ2VyLmVuYWJsZWREZWJ1Z0RyYXcgPSB0cnVlO1xuICAgICAgICAvLyBtYW5hZ2VyLmVuYWJsZWREcmF3Qm91bmRpbmdCb3ggPSB0cnVlO1xuXG5cbiAgICAgICAgLy8g5pOC5Y+w6LWb6K6w5b2VXG4gICAgICAgIE1hdGguc2VlZCA9IG5ldyBEYXRlKCkuZ2V0RGF0ZSgpO1xuICAgICAgICB0aGlzLnNlZWQgPSBNYXRoLnNlZWQ7XG4gICAgICAgIC8qZ2xvYmFsLnRpbWUgPSAwO1xuICAgICAgICBnbG9iYWwucmVjb3JkID0ge307XG5cblx0XHR0aGlzLnJfZGF0YSA9IEpTT04ucGFyc2UoY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyJykpO1xuICAgICAgICB0aGlzLnJfZGF0YSA9IHRoaXMucl9kYXRhIHx8IHtcbiAgICAgICAgICAgIDEyOlwiMVwiLFxuICAgICAgICAgICAgMTg6XCIwXCIsXG4gICAgICAgICAgICAyMjpcIjFcIixcbiAgICAgICAgICAgIDI5OlwiMFwiLFxuICAgICAgICAgICAgMzI6XCIxXCIsXG4gICAgICAgICAgICA0NDpcIjBcIixcbiAgICAgICAgICAgIDQ4OlwiMVwiLFxuICAgICAgICAgICAgNTc6XCIwXCIsXG4gICAgICAgICAgICA2MzpcIjFcIixcbiAgICAgICAgICAgIDcxOlwiMFwiLFxuICAgICAgICAgICAgNzU6XCIxXCIsXG4gICAgICAgICAgICA4MjpcIjBcIlxuICAgICAgICB9Ki9cblxuICAgICAgICAvKnRoaXMuc2NoZWR1bGUoZnVuY3Rpb24oYXJndW1lbnQpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZ2xvYmFsLnRpbWUgKz0gMTtcblxuICAgICAgICAgICAgaWYodGhpcy5yX2RhdGFbZ2xvYmFsLnRpbWVdID09IDEpIHtcbiAgICAgICAgICAgICAgICBpZighZ2xvYmFsLmdhbWVvdmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9vMi54diA9IHRoaXMuYm9vMi5vcmlfeHY7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9vMi54YSA9IHRoaXMuYm9vMi5vcmlfeGE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9vMl9tb3ZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih0aGlzLnJfZGF0YVtnbG9iYWwudGltZV0gPT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYm9vMl9tb3ZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDAuMDEsIHRoaXMpOyovXG5cbiAgICAgICAgLy8g5pOC5Y+w6LWbXG4gICAgICAgIGdsb2JhbC5ib251cyA9IDA7XG5cbiAgICAgICAgLy8gdGhpcy5ib28ub3JpX3h2ID0gMTtcbiAgICAgICAgLy8gdGhpcy5ib28ub3JpX3hhID0gMC4yO1xuXG4gICAgICAgIHRoaXMuYm9vLnh2ID0gdGhpcy5ib28ub3JpX3h2O1xuICAgICAgICB0aGlzLmJvby54YSA9IHRoaXMuYm9vLm9yaV94YTtcblxuICAgICAgICB0aGlzLmJvby5tb2RlID0gXCJsZWl0YWlcIjtcblxuICAgICAgICBnbG9iYWwuZGlzdGFuY2UgPSAwO1xuICAgICAgICBnbG9iYWwubnVtID0gMDtcbiAgICAgICAgZ2xvYmFsLmdhbWVvdmVyID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5lZGdlID0gMDtcblxuICAgICAgICB0aGlzLmJvb19tb3ZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24gKCBldmVudCApIHtcbiAgICAgICAgICAgIGlmKCFnbG9iYWwuZ2FtZW92ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJvby54diA9IHRoaXMuYm9vLm9yaV94djtcbiAgICAgICAgICAgICAgICB0aGlzLmJvby54YSA9IHRoaXMuYm9vLm9yaV94YTtcbiAgICAgICAgICAgICAgICB0aGlzLmJvb19tb3ZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyBnbG9iYWwucmVjb3JkW2dsb2JhbC50aW1lXSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgICB0aGlzLm5vZGUub24oJ3RvdWNoZW5kJywgZnVuY3Rpb24gKCBldmVudCApIHtcbiAgICAgICAgICAgIHRoaXMuYm9vX21vdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vIGdsb2JhbC5yZWNvcmRbZ2xvYmFsLnRpbWVdID0gMDtcbiAgICAgICAgfSwgdGhpcyk7XG5cblxuICAgICAgICBpZih0eXBlb2Yod3gpICE9IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgd3guc2hvd1NoYXJlTWVudSh7XG4gICAgICAgICAgICAgIHdpdGhTaGFyZVRpY2tldDogdHJ1ZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHd4LnVwZGF0ZVNoYXJlTWVudSh7XG4gICAgICAgICAgICAgIHdpdGhTaGFyZVRpY2tldDogdHJ1ZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHd4Lm9uU2hhcmVBcHBNZXNzYWdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgLy8g55So5oi354K55Ye75LqG4oCc6L2s5Y+R4oCd5oyJ6ZKuXG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICflpb3mg7PmiJDkuLrku4rml6Xmk4LkuLvllYrvvIEnLFxuICAgICAgICAgICAgICAgIGltYWdlVXJsOiBcInJlcy9yYXctYXNzZXRzL1RleHR1cmUvc2hhcmUvczIucG5nXCIsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICB3eC5sb2dpbih7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChsb2dpbkNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5kYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnbGVpdGFpX2NoZWNrJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdzZWVkJzogc2VsZi5zZWVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2xvZ2luQ29kZSc6IGxvZ2luQ29kZS5jb2RlXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgd3gucmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICdodHRwczovL3VybC8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBzZWxmLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+iuvue9ruWPguaVsOWGheWuueexu+Wei+S4ungtd3d3LWZvcm0tdXJsZW5jb2RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOidhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcdHZhciB0ID0gMyAtIHJlcy5kYXRhWzBdLm51bTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlcy5kYXRhWzBdLm51bSA+IDEwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+Wwj+WNnDonLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogJ+S9oOW3suaMkeaImOi2hei/hzEw5qyh5LqG5ZOf4oCm4oCm5Y676K+V6K+V5pyA5by65qih5byP5oiW552A57uD5Lmg5qih5byP5ZCnficsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24gKGFyZ3VtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm91dE9mVG9kYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYodCA+IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHd4LnNob3dNb2RhbCh7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICflsI/ljZw6Jyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAn5L2g5LuK5aSp6L+Y5YmpJyArIHQgKyAn5qyh5oyR5oiY5py65LyaficsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlcy5jYW5jZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5vdXRPZlRvZGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24gKGFyZ3VtZW50KSB7XG5cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0fSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHd4LnNob3dNb2RhbCh7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICflsI/ljZw6Jyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAn5L2g5LuK5aSp55qE5oyR5oiY5py65Lya5bey57uP55So5a6M5LqG5ZOffu+8jOWIhuS6q+WIsOe+pOWPr+S7peiOt+W+l+mineWklueahOaMkeaImOacuuS8micsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlcy5jb25maXJtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHd4LnNoYXJlQXBwTWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+WlveaDs+aIkOS4uuS7iuaXpeaTguS4u+WViu+8gScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZVVybDogXCJyZXMvcmF3LWFzc2V0cy9UZXh0dXJlL3NoYXJlL3MyLnBuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXJlcy5zaGFyZVRpY2tldHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn5bCP5Y2cOicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAn5LiN6KaB6LCD55qu5ZOmfuebtOaOpeeCueW8gOWni+a4uOaIj+ayoeacieavj+aXpeaMkeaImOasoeaVsOmZkOWItn4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uIChhcmd1bWVudCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5vdXRPZlRvZGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uKHJlcykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICflsI/ljZw6JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogJ+ebtOaOpeeCueW8gOWni+a4uOaIj+ayoeacieavj+aXpeaMkeaImOasoeaVsOmZkOWItuWTpn4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uIChhcmd1bWVudCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm91dE9mVG9kYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3guc2hvd01vZGFsKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn5bCP5Y2cOicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAn55u05o6l54K55byA5aeL5ri45oiP5rKh5pyJ5q+P5pel5oyR5oiY5qyh5pWw6ZmQ5Yi25ZOmficsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24gKGFyZ3VtZW50KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYub3V0T2ZUb2RheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uIChhcmd1bWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYub3V0T2ZUb2RheSgpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdmJyxyZXMpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0QkxvY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcmFuZCA9IE1hdGguZmxvb3IoTWF0aC5zZWVkZWRSYW5kb20oKSAqIHRoaXMuYmxvY2subGVuZ3RoKTtcbiAgICAgICAgdmFyIGJsb2NrID0gY2MuaW5zdGFudGlhdGUodGhpcy5ibG9ja1tyYW5kXSk7XG5cbiAgICAgICAgYmxvY2suc2V0UG9zaXRpb24oZ2xvYmFsLmRpc3RhbmNlICsgNDAwLCAtMTAwKTtcbiAgICAgICAgYmxvY2suc2NhbGVYID0gTWF0aC5taW4oMSwgTWF0aC5tYXgoMCwgKDIwMCAtIGdsb2JhbC5udW0pIC8gMjAwKSkgKyBNYXRoLnNlZWRlZFJhbmRvbSgpICogMC4yICsgMC4yO1xuICAgICAgICBibG9jay5zY2FsZVkgPSBibG9jay5zY2FsZVg7XG5cbiAgICAgICAgLyp2YXIgYmxvY2syID0gY2MuaW5zdGFudGlhdGUoYmxvY2spO1xuICAgICAgICBibG9jazIucGFyZW50ID0gdGhpcy5tYXAyOyovXG5cbiAgICAgICAgYmxvY2sucGFyZW50ID0gdGhpcy5tYXA7XG5cbiAgICB9LFxuXG4gICAgc2V0UHJvcDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciByYW5kID0gTWF0aC5mbG9vcihNYXRoLnNlZWRlZFJhbmRvbSgpICogdGhpcy5wcm9wLmxlbmd0aCk7XG4gICAgICAgIHZhciBwcm9wID0gY2MuaW5zdGFudGlhdGUodGhpcy5wcm9wW3JhbmRdKTtcblxuICAgICAgICBwcm9wLnNldFBvc2l0aW9uKGdsb2JhbC5kaXN0YW5jZSArIDQwMCAtIE1hdGguc2VlZGVkUmFuZG9tKCkgKiAyMDAsIDIwMCk7XG5cbiAgICAgICAgcHJvcC5zZWVkID0gTWF0aC5zZWVkZWRSYW5kb20oKTtcblxuICAgICAgICAvKnZhciBwcm9wMiA9IGNjLmluc3RhbnRpYXRlKHByb3ApO1xuICAgICAgICBwcm9wMi5zZWVkID0gcHJvcC5zZWVkO1xuICAgICAgICBwcm9wMi5wYXJlbnQgPSB0aGlzLm1hcDI7Ki9cblxuICAgICAgICBwcm9wLnBhcmVudCA9IHRoaXMubWFwO1xuXG4gICAgfSxcblxuICAgIHNldE51bTogZnVuY3Rpb24obnVtKSB7XG4gICAgICAgIGdsb2JhbC5udW0gKz0gbnVtICsgZ2xvYmFsLmJvbnVzO1xuICAgICAgICB0aGlzLm51bS5zdHJpbmcgPSBnbG9iYWwubnVtO1xuICAgIH0sXG5cbiAgICBzZXRUaXA6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICB0aGlzLnRpcHMuc3RyaW5nID0gc3RyO1xuICAgIH0sXG5cbiAgICBvdXRPZlRvZGF5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coZ2xvYmFsLnJlY29yZClcbiAgICAgICAgLy8gY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyJywgSlNPTi5zdHJpbmdpZnkoZ2xvYmFsLnJlY29yZCkpO1xuICAgICAgICB0aGlzLmJvby5kZXN0cm95KCk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgZ2xvYmFsLmdhbWVvdmVyID0gdHJ1ZTtcblxuICAgICAgICBzZWxmLmRhdGEgPSB7XG4gICAgICAgICAgICAndHlwZSc6ICdsZWl0YWknLFxuICAgICAgICAgICAgJ3NlZWQnOiBzZWxmLnNlZWRcbiAgICAgICAgfVxuICAgICAgICBnbG9iYWwucmFuay5zaG93V3Jhbmsoc2VsZi5kYXRhKTtcbiAgICB9LFxuXG4gICAgZW5kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coZ2xvYmFsLnJlY29yZClcbiAgICAgICAgLy8gY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyJywgSlNPTi5zdHJpbmdpZnkoZ2xvYmFsLnJlY29yZCkpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGdsb2JhbC5nYW1lb3ZlciA9IHRydWU7XG5cbiAgICAgICAgLyp3eC5zaG93TW9kYWwoe1xuICAgICAgICAgICAgdGl0bGU6ICflsI/ljZw6JyxcbiAgICAgICAgICAgIGNvbnRlbnQ6ICflrozmiJDmjJHmiJjvvIznjrDlnKjmraPlnKjnu5PnrpfkvaDnmoTliIbmlbB+JyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uIChhcmd1bWVudCkge1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pOyovXG5cbiAgICAgICAgc2VsZi5kYXRhID0ge1xuICAgICAgICAgICAgJ3R5cGUnOiAnbGVpdGFpJyxcbiAgICAgICAgICAgICdudW0nOiBnbG9iYWwubnVtLFxuICAgICAgICAgICAgJ3NlZWQnOiBzZWxmLnNlZWRcbiAgICAgICAgfVxuICAgICAgICBnbG9iYWwucmFuay5zaG93V3Jhbmsoc2VsZi5kYXRhKTtcbiAgICB9LFxuXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAgICAgLypnbG9iYWwudGltZSArPSAxO1xuXG4gICAgICAgIGlmKHRoaXMucl9kYXRhW2dsb2JhbC50aW1lXSA9PSAxKSB7XG4gICAgICAgICAgICBpZighZ2xvYmFsLmdhbWVvdmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ib28yLnh2ID0gdGhpcy5ib28yLm9yaV94djtcbiAgICAgICAgICAgICAgICB0aGlzLmJvbzIueGEgPSB0aGlzLmJvbzIub3JpX3hhO1xuICAgICAgICAgICAgICAgIHRoaXMuYm9vMl9tb3ZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZih0aGlzLnJfZGF0YVtnbG9iYWwudGltZV0gPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5ib28yX21vdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHRoaXMuYm9vMl9tb3ZlKSB7XG4gICAgICAgICAgICB0aGlzLm1hcDIueCAtPSB0aGlzLmJvbzIueHY7XG4gICAgICAgICAgICB0aGlzLmJvbzIueHYgKz0gdGhpcy5ib28yLnhhO1xuXG4gICAgICAgICAgICB0aGlzLnN0YWdlMi54ICs9IHRoaXMuYm9vMi54djtcbiAgICAgICAgfSovXG5cbiAgICAgICAgaWYodGhpcy5ib29fbW92ZSkge1xuICAgICAgICAgICAgdGhpcy5tYXAueCAtPSB0aGlzLmJvby54djtcbiAgICAgICAgICAgIHRoaXMuYm9vLnh2ICs9IHRoaXMuYm9vLnhhO1xuXG4gICAgICAgICAgICAvLyB0aGlzLnN0YWdlMi54IC09IHRoaXMuYm9vLnh2O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYodGhpcy5ib28yX21vdmUgfHwgdGhpcy5ib29fbW92ZSkge1xuICAgICAgICBpZih0aGlzLmJvb19tb3ZlKSB7XG4gICAgICAgICAgICBnbG9iYWwuZGlzdGFuY2UgKz0gdGhpcy5ib28ueHY7XG4gICAgICAgICAgICAvLyBnbG9iYWwuZGlzdGFuY2UgPSBNYXRoLm1heCgtdGhpcy5tYXAueCwgLXRoaXMubWFwMi54KTtcbiAgICAgICAgICAgIC8vIHRoaXMuc3RhZ2UyLnggPSB0aGlzLm1hcC54IC0gdGhpcy5tYXAyLng7XG4gICAgICAgICAgICBpZihnbG9iYWwuZGlzdGFuY2UgPiB0aGlzLmVkZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVkZ2UgKz0gMjAwICsgTWF0aC5zZWVkZWRSYW5kb20oKSAqIDIwMCArIHRoaXMuYm9vLnh2ICogdGhpcy5ib28ueHY7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRCTG9jaygpO1xuICAgICAgICAgICAgICAgIGlmKGdsb2JhbC5udW0gJSA1MCA+IDQ1KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBjYy50aW50VG8oMiwgTWF0aC5zZWVkZWRSYW5kb20oKSAqIDI1NSwgTWF0aC5zZWVkZWRSYW5kb20oKSAqIDI1NSwgTWF0aC5zZWVkZWRSYW5kb20oKSAqIDI1NSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmcucnVuQWN0aW9uKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKE1hdGguc2VlZGVkUmFuZG9tKCkgPCAwLjMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyppZighZ2xvYmFsLmdhbWVvdmVyKSB7XG4gICAgICAgICAgICBpZih0aGlzLmJvby55ID4gNDAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFnZS5zY2FsZVggPSBNYXRoLm1heCgwLjIsIDEgLSAodGhpcy5ib28ueSAtIDQwMCkgLyAxMDAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YWdlLnNjYWxlWSA9IE1hdGgubWF4KDAuMiwgMSAtICh0aGlzLmJvby55IC0gNDAwKSAvIDEwMDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YWdlLnNjYWxlWCA9IDE7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFnZS5zY2FsZVkgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9Ki9cblxuICAgIH0sXG59KTtcbiJdfQ==