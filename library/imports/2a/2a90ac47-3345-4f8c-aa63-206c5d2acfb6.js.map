{"version":3,"sources":["assets/Script/Scene/Leitai.js"],"names":["global","require","cc","Class","Component","properties","num","type","Label","map","Node","block","Prefab","prop","tips","stage","boo","bg","onLoad","game","manager","director","getCollisionManager","enabled","Math","seed","Date","getDate","bonus","xv","ori_xv","xa","ori_xa","mode","distance","gameover","edge","boo_move","node","on","event","wx","self","showShareMenu","withShareTicket","updateShareMenu","onShareAppMessage","title","imageUrl","success","res","login","loginCode","data","code","request","url","method","header","t","showModal","content","fail","argument","outOfToday","cancel","confirm","shareAppMessage","shareTickets","setBLock","rand","floor","seededRandom","length","instantiate","setPosition","scaleX","min","max","scaleY","parent","setProp","setNum","string","setTip","str","destroy","rank","showWrank","end","update","dt","x","action","tintTo","runAction"],"mappings":"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","sourceRoot":"/","sourcesContent":["var global = require(\"global\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        num: {\n            default: null,\n            type: cc.Label\n        },\n        map: {\n            default: null,\n            type: cc.Node\n        },\n        block: {\n            default: [],\n            type: cc.Prefab\n        },\n        prop: {\n            default: [],\n            type: cc.Prefab\n        },\n        tips: {\n            default: null,\n            type: cc.Label\n        },\n        stage: {\n            default: null,\n            type: cc.Node\n        },\n        boo: {\n            default: null,\n            type: cc.Node\n        },\n        bg: {\n            default: null,\n            type: cc.Node\n        },\n        /*stage2: {\n            default: null,\n            type: cc.Node\n        },\n        map2: {\n            default: null,\n            type: cc.Node\n        },\n        boo2: {\n            default: null,\n            type: cc.Node\n        }*/\n    },\n\n    // use this for initialization\n    onLoad: function () {\n\n\n\n        global.game = this;\n\n        var manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n        // manager.enabledDebugDraw = true;\n        // manager.enabledDrawBoundingBox = true;\n\n\n        // 擂台赛记录\n        Math.seed = new Date().getDate();\n        this.seed = Math.seed;\n        /*global.time = 0;\n        global.record = {};\n\n\t\tthis.r_data = JSON.parse(cc.sys.localStorage.getItem('r'));\n        this.r_data = this.r_data || {\n            12:\"1\",\n            18:\"0\",\n            22:\"1\",\n            29:\"0\",\n            32:\"1\",\n            44:\"0\",\n            48:\"1\",\n            57:\"0\",\n            63:\"1\",\n            71:\"0\",\n            75:\"1\",\n            82:\"0\"\n        }*/\n\n        /*this.schedule(function(argument) {\n            \n            global.time += 1;\n\n            if(this.r_data[global.time] == 1) {\n                if(!global.gameover) {\n                    this.boo2.xv = this.boo2.ori_xv;\n                    this.boo2.xa = this.boo2.ori_xa;\n                    this.boo2_move = true;\n                }\n            }\n            if(this.r_data[global.time] == 0) {\n                this.boo2_move = false;\n            }\n        }, 0.01, this);*/\n\n        // 擂台赛\n        global.bonus = 0;\n\n        // this.boo.ori_xv = 1;\n        // this.boo.ori_xa = 0.2;\n\n        this.boo.xv = this.boo.ori_xv;\n        this.boo.xa = this.boo.ori_xa;\n\n        this.boo.mode = \"leitai\";\n\n        global.distance = 0;\n        global.num = 0;\n        global.gameover = false;\n\n        this.edge = 0;\n\n        this.boo_move = false;\n\n        this.node.on('touchstart', function ( event ) {\n            if(!global.gameover) {\n                this.boo.xv = this.boo.ori_xv;\n                this.boo.xa = this.boo.ori_xa;\n                this.boo_move = true;\n                // global.record[global.time] = 1;\n            }\n        }, this);\n        this.node.on('touchend', function ( event ) {\n            this.boo_move = false;\n            // global.record[global.time] = 0;\n        }, this);\n\n\n        if(typeof(wx) != \"undefined\") {\n            var self = this;\n\n            wx.showShareMenu({\n              withShareTicket: true\n            });\n\n            wx.updateShareMenu({\n              withShareTicket: true\n            });\n\n            wx.onShareAppMessage(function () {\n              // 用户点击了“转发”按钮\n              return {\n                title: '好想成为今日擂主啊！',\n                imageUrl: \"res/raw-assets/Texture/share/s2.png\",\n                success: function(res) {\n                }\n              }\n            });\n\n\n            wx.login({\n              success: function (loginCode) {\n                    self.data = {\n                        'type': 'leitai_check',\n                        'seed': self.seed,\n                        'loginCode': loginCode.code\n                    };\n\n                    wx.request({\n                        url: 'https://url/',\n                        method: 'POST',\n                        data: self.data,\n                        header: {\n                            //设置参数内容类型为x-www-form-urlencoded\n                            'Content-Type':'application/x-www-form-urlencoded',\n                            'Accept': 'application/json'\n                        },\n                        success: function (res) {\n                        \tvar t = 3 - res.data[0].num;\n\n                            if(res.data[0].num > 10) {\n                                wx.showModal({\n                                    title: '小卜:',\n                                    content: '你已挑战超过10次了哟……去试试最强模式或着练习模式吧~',\n                                    success: function (res) {\n                                    },\n                                    fail: function (argument) {\n                                    }\n                                });\n                                self.outOfToday();\n                            } else if(t > 0) {\n\t                            wx.showModal({\n\t                                title: '小卜:',\n\t                                content: '你今天还剩' + t + '次挑战机会~',\n\t                                success: function (res) {\n                                        if(res.cancel) {\n                                            self.outOfToday();\n                                        }\n\t                                },\n\t                                fail: function (argument) {\n\n\t                                }\n\t                            });\n                        \t} else {\n\t                            wx.showModal({\n\t                                title: '小卜:',\n\t                                content: '你今天的挑战机会已经用完了哟~，分享到群可以获得额外的挑战机会',\n\t                                success: function (res) {\n                                        if(res.confirm) {\n                                            wx.shareAppMessage({\n                                                title: '好想成为今日擂主啊！',\n                                                imageUrl: \"res/raw-assets/Texture/share/s2.png\",\n                                                success: function(res) {\n                                                    if(!res.shareTickets) {\n                                                        wx.showModal({\n                                                            title: '小卜:',\n                                                            content: '不要调皮哦~直接点开始游戏没有每日挑战次数限制~',\n                                                            success: function (res) {\n                                                            },\n                                                            fail: function (argument) {\n\n                                                            }\n                                                        });\n                                                        \n                                                        self.outOfToday();\n                                                    }\n                                                },\n                                                fail: function(res) {\n\n                                                    wx.showModal({\n                                                        title: '小卜:',\n                                                        content: '直接点开始游戏没有每日挑战次数限制哦~',\n                                                        success: function (res) {\n                                                        },\n                                                        fail: function (argument) {\n\n                                                        }\n                                                    });\n                                                    self.outOfToday();\n                                                }\n                                            });\n                                        } else {\n                                            wx.showModal({\n                                                title: '小卜:',\n                                                content: '直接点开始游戏没有每日挑战次数限制哦~',\n                                                success: function (res) {\n                                                },\n                                                fail: function (argument) {\n\n                                                }\n                                            });\n                                            self.outOfToday();\n                                        }\n\t                                },\n\t                                fail: function (argument) {\n                                        self.outOfToday();\n\t                                }\n\t                            });\n                        \t}\n                        },\n                        fail: function (res) {\n                            // console.log('f',res)\n                        }\n                    });\n                }\n            });\n\n        }\n    },\n\n    setBLock: function() {\n        var rand = Math.floor(Math.seededRandom() * this.block.length);\n        var block = cc.instantiate(this.block[rand]);\n\n        block.setPosition(global.distance + 400, -100);\n        block.scaleX = Math.min(1, Math.max(0, (200 - global.num) / 200)) + Math.seededRandom() * 0.2 + 0.2;\n        block.scaleY = block.scaleX;\n\n        /*var block2 = cc.instantiate(block);\n        block2.parent = this.map2;*/\n\n        block.parent = this.map;\n\n    },\n\n    setProp: function() {\n        var rand = Math.floor(Math.seededRandom() * this.prop.length);\n        var prop = cc.instantiate(this.prop[rand]);\n\n        prop.setPosition(global.distance + 400 - Math.seededRandom() * 200, 200);\n\n        prop.seed = Math.seededRandom();\n\n        /*var prop2 = cc.instantiate(prop);\n        prop2.seed = prop.seed;\n        prop2.parent = this.map2;*/\n\n        prop.parent = this.map;\n\n    },\n\n    setNum: function(num) {\n        global.num += num + global.bonus;\n        this.num.string = global.num;\n    },\n\n    setTip: function(str) {\n        this.tips.string = str;\n    },\n\n    outOfToday: function() {\n        // console.log(global.record)\n        // cc.sys.localStorage.setItem('r', JSON.stringify(global.record));\n        this.boo.destroy();\n        var self = this;\n        global.gameover = true;\n\n        self.data = {\n            'type': 'leitai',\n            'seed': self.seed\n        }\n        global.rank.showWrank(self.data);\n    },\n\n    end: function() {\n        // console.log(global.record)\n        // cc.sys.localStorage.setItem('r', JSON.stringify(global.record));\n        var self = this;\n        global.gameover = true;\n\n        /*wx.showModal({\n            title: '小卜:',\n            content: '完成挑战，现在正在结算你的分数~',\n            success: function (res) {\n\n            },\n            fail: function (argument) {\n\n            }\n        });*/\n\n        self.data = {\n            'type': 'leitai',\n            'num': global.num,\n            'seed': self.seed\n        }\n        global.rank.showWrank(self.data);\n    },\n\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n\n        /*global.time += 1;\n\n        if(this.r_data[global.time] == 1) {\n            if(!global.gameover) {\n                this.boo2.xv = this.boo2.ori_xv;\n                this.boo2.xa = this.boo2.ori_xa;\n                this.boo2_move = true;\n            }\n        }\n        if(this.r_data[global.time] == 0) {\n            this.boo2_move = false;\n        }\n\n        if(this.boo2_move) {\n            this.map2.x -= this.boo2.xv;\n            this.boo2.xv += this.boo2.xa;\n\n            this.stage2.x += this.boo2.xv;\n        }*/\n\n        if(this.boo_move) {\n            this.map.x -= this.boo.xv;\n            this.boo.xv += this.boo.xa;\n\n            // this.stage2.x -= this.boo.xv;\n        }\n\n        // if(this.boo2_move || this.boo_move) {\n        if(this.boo_move) {\n            global.distance += this.boo.xv;\n            // global.distance = Math.max(-this.map.x, -this.map2.x);\n            // this.stage2.x = this.map.x - this.map2.x;\n            if(global.distance > this.edge) {\n                this.edge += 200 + Math.seededRandom() * 200 + this.boo.xv * this.boo.xv;\n                this.setBLock();\n                if(global.num % 50 > 45) {\n                    var action = cc.tintTo(2, Math.seededRandom() * 255, Math.seededRandom() * 255, Math.seededRandom() * 255);\n                    this.bg.runAction(action);\n                }\n                if(Math.seededRandom() < 0.3) {\n                    this.setProp();\n                }\n            }\n        }\n\n        /*if(!global.gameover) {\n            if(this.boo.y > 400) {\n                this.stage.scaleX = Math.max(0.2, 1 - (this.boo.y - 400) / 1000);\n                this.stage.scaleY = Math.max(0.2, 1 - (this.boo.y - 400) / 1000);\n            } else {\n                this.stage.scaleX = 1;\n                this.stage.scaleY = 1;\n            }\n        }*/\n\n    },\n});\n"]}